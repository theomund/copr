# COPR - Packages for Fedora COPR.
# Copyright (C) 2025 Theomund
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program. If not, see <https://www.gnu.org/licenses/>.

---
jobs:
  - job: copr_build
    trigger: pull_request
    targets:
      - fedora-41-x86_64

packages:
  limine:
    actions:
      get-current-version:
        - bash -c "rpmspec -q --queryformat '%{VERSION}\n' limine.spec | head -n 1"
      create-archive:
        - bash -c "wget2 -O limine-${PACKIT_PROJECT_VERSION}-binary.tar.gz https://github.com/limine-bootloader/limine/archive/refs/tags/v${PACKIT_PROJECT_VERSION}-binary.tar.gz"
        - bash -c "ls -1 limine-${PACKIT_PROJECT_VERSION}-binary.tar.gz"
      fix-spec-file: []
    paths:
      - ./limine
    release_suffix: dev
    specfile_path: limine.spec
